<!DOCTYPE html>

<html>
<head>
  <title>Test Evented Class</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="test-evented-class">Test Evented Class</h1>
<ul>
<li>Parent: <a href="./index.html">Test</a></li>
</ul>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>should = <span class="hljs-built_in">require</span> <span class="hljs-string">'should'</span>
Node = <span class="hljs-built_in">require</span> <span class="hljs-string">'../node'</span>
Event = <span class="hljs-built_in">require</span> <span class="hljs-string">'../event'</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">(Evented, name = <span class="hljs-string">'Evented'</span>)</span> -&gt;</span>
  describe name, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should be a class'</span>, <span class="hljs-function">-&gt;</span> Evented.should.be.a.class
    describe <span class="hljs-string">'#constructor()'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return an instance of Evented'</span>, <span class="hljs-function">-&gt;</span>
        (<span class="hljs-keyword">new</span> Evented).should.be.an.<span class="hljs-keyword">instanceof</span> Evented

    describe <span class="hljs-string">'#constructor()'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return an instance of Evented'</span>, <span class="hljs-function">-&gt;</span>
        (<span class="hljs-keyword">new</span> Evented).should.be.an.<span class="hljs-keyword">instanceof</span> Evented</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>The Evented <a href="../base.html#constructor">constructor</a> should set the <strong>#listeners</strong>
to an array with two empty objects. For normal and for capturing listeners.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe <span class="hljs-string">'#listeners'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should be an array of two objects'</span>, <span class="hljs-function">-&gt;</span>
        (<span class="hljs-keyword">new</span> Evented).listeners.length.should.be.equal <span class="hljs-number">2</span>
        (<span class="hljs-keyword">new</span> Evented).listeners[<span class="hljs-number">0</span>].should.be.an.Object
        (<span class="hljs-keyword">new</span> Evented).listeners[<span class="hljs-number">1</span>].should.be.an.Object</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>The [#addListener()][Event#addListener] method should add a <strong>listener</strong>
to the matching <strong>phase</strong> (capturing/normal) object, under and matching <strong>type</strong>
key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe <span class="hljs-string">'#addListener(type, listener, capture = false)'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return the evented'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented).addListener().should.be.equal test

      it <span class="hljs-string">'should add event listener to normal listeners (default)'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>))
          .listeners[<span class="hljs-number">0</span>].test[<span class="hljs-number">0</span>].should.be.equal listener

      it <span class="hljs-string">'should add event listener to normal listeners (default) (named arguments)'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-attribute">type</span>:<span class="hljs-string">'test'</span>, <span class="hljs-attribute">listener</span>:(listener = <span class="hljs-function">-&gt;</span>)
          .listeners[<span class="hljs-number">0</span>].test[<span class="hljs-number">0</span>].should.be.equal listener

      it <span class="hljs-string">'should add event listener to capturing listeners'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>), <span class="hljs-literal">yes</span>)
          .listeners[<span class="hljs-number">1</span>].test[<span class="hljs-number">0</span>].should.be.equal listener

      it <span class="hljs-string">'should add event listener to capturing listeners (named arguments)'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-attribute">type</span>:<span class="hljs-string">'test'</span>, <span class="hljs-attribute">listener</span>:(listener = <span class="hljs-function">-&gt;</span>), <span class="hljs-attribute">capture</span>:<span class="hljs-literal">yes</span>
          .listeners[<span class="hljs-number">1</span>].test[<span class="hljs-number">0</span>].should.be.equal listener

      it <span class="hljs-string">'should not add duplicates'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>))
          .addListener(<span class="hljs-string">'test'</span>, listener)
          .listeners[<span class="hljs-number">0</span>].test.length.should.be.equal <span class="hljs-number">1</span>

        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>), <span class="hljs-literal">yes</span>)
          .addListener(<span class="hljs-string">'test'</span>, listener, <span class="hljs-literal">yes</span>)
          .listeners[<span class="hljs-number">1</span>].test.length.should.be.equal <span class="hljs-number">1</span>

      it <span class="hljs-string">'should add only functions'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-string">'test'</span>, {}
          .listeners[<span class="hljs-number">0</span>].should.<span class="hljs-keyword">not</span>.have.property <span class="hljs-string">'test'</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-string">'test'</span>, {}, <span class="hljs-literal">yes</span>
          .listeners[<span class="hljs-number">1</span>].should.<span class="hljs-keyword">not</span>.have.property <span class="hljs-string">'test'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>The [#removeListener][Evented#removelistener] method should remove the <strong>listener</strong>
from the the matching <strong>phase</strong> (capturing/normal) object, under and matching <strong>type</strong>
key.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe <span class="hljs-string">'#removeListener(type, listener, capture = false)'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return the Evented instance'</span>, <span class="hljs-function">-&gt;</span>

        (test = <span class="hljs-keyword">new</span> Evented).removeListener().should.be.equal test

      it <span class="hljs-string">'should remove the listener from normal listeners'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>))
          .removeListener(<span class="hljs-string">'test'</span>, listener)
          .listeners[<span class="hljs-number">0</span>].test.length.should.be.equal <span class="hljs-number">0</span>

      it <span class="hljs-string">'should remove the listener from normal listeners (args)'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>))
          .removeListener <span class="hljs-attribute">type</span>:<span class="hljs-string">'test'</span>, <span class="hljs-attribute">listener</span>:listener
          .listeners[<span class="hljs-number">0</span>].test.length.should.be.equal <span class="hljs-number">0</span>

      it <span class="hljs-string">'should remove the listener from capturing listeners'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>), <span class="hljs-literal">yes</span>)
          .removeListener(<span class="hljs-string">'test'</span>, listener, <span class="hljs-literal">yes</span>)
          .listeners[<span class="hljs-number">1</span>].test.length.should.be.equal <span class="hljs-number">0</span>

      it <span class="hljs-string">'should remove the listener from capturing listeners (args)'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener(<span class="hljs-string">'test'</span>, (listener = <span class="hljs-function">-&gt;</span>), <span class="hljs-literal">yes</span>)
          .removeListener <span class="hljs-attribute">type</span>:<span class="hljs-string">'test'</span>, <span class="hljs-attribute">listener</span>:listener, <span class="hljs-attribute">capture</span>:<span class="hljs-literal">yes</span>
          .listeners[<span class="hljs-number">1</span>].test.length.should.be.equal <span class="hljs-number">0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>The [#dispatchEvent][Evented#dispatchEvent] method should dispatch the event to the listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe <span class="hljs-string">'#dispatchEvent(event)'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return the Evented instance'</span>, <span class="hljs-function">-&gt;</span>

        (test = <span class="hljs-keyword">new</span> Evented).dispatchEvent().should.be.equal test</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>it should dispatch to <strong>normal</strong> listeners if the phase is AT_TARGET (2)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it <span class="hljs-string">'should dispatch the event to normal listeners when phase is AT_TARGET'</span>, <span class="hljs-function">-&gt;</span>
        count = <span class="hljs-number">0</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).phase = <span class="hljs-number">2</span>
        (<span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-string">'test'</span>, <span class="hljs-function">-&gt;</span> count++
          .addListener <span class="hljs-string">'test'</span>, <span class="hljs-function">-&gt;</span> count++
          .addListener <span class="hljs-string">'test'</span>, <span class="hljs-function">-&gt;</span> count++
          .dispatchEvent event
        count.should.be.equal <span class="hljs-number">3</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>it should dispatch to <strong>capturing</strong> listeners if the phase is CAPTURING (1)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it <span class="hljs-string">'should dispatch the event to capturing listeners'</span>, <span class="hljs-function">-&gt;</span>
        count = <span class="hljs-number">0</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).phase = <span class="hljs-number">1</span>
        (<span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> count++), <span class="hljs-literal">yes</span>
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> count++), <span class="hljs-literal">yes</span>
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> count++), <span class="hljs-literal">yes</span>
          .dispatchEvent event
        count.should.be.equal <span class="hljs-number">3</span>

      it <span class="hljs-string">'should not dispatch events in any other phase'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>
        test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>
        test
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>)
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>), <span class="hljs-literal">yes</span>
          .dispatchEvent event
        pass.should.be.ok

        event.phase = <span class="hljs-number">3</span>
        test.dispatchEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should not dispatch aborted events'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).phase = <span class="hljs-number">1</span>
        event.abort()
        test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>
        test
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>)
          .addListener <span class="hljs-string">'test'</span>, (<span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>), <span class="hljs-literal">yes</span>
          .dispatchEvent event
        pass.should.be.ok

        event.phase = <span class="hljs-number">2</span>
        test.dispatchEvent event
        pass.should.be.ok</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>The [#broadcastEvent][Evented#broadcastEvent] should process the event and dispatch it to listeners
if needed. After that, if its appropriate, the event should be broadcasted to the children.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe <span class="hljs-string">'#broadcastEvent(event)'</span>, <span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should return the Evented instance'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented).broadcastEvent().should.be.equal test

      it <span class="hljs-string">'should set event phase to capturing if phase is not truthly'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">no</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>)
        child.broadcastEvent = <span class="hljs-function"><span class="hljs-params">(e)</span> -&gt;</span> pass = (e.phase <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>)
        parent.broadcastEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should broadcast the event to children'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">no</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        child.broadcastEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">yes</span>
        parent.broadcastEvent <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>
        pass.should.be.ok

      it <span class="hljs-string">'should set the Evented instance as the event source if there is no source already'</span>, <span class="hljs-function">-&gt;</span>
        (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).broadcastEvent(event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>)
        event.___runtime.source.should.be.equal test</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>When the event has reached it’s target, or there is nowhere to broadcast the event anymore,
the event callback must be called</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it <span class="hljs-string">'should not broadcast the event to children if this Evented instance is the target of the event'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).target = parent
        child.broadcastEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        parent.broadcastEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should not broadcast finished event to children'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).phase = <span class="hljs-number">4</span>
        child.broadcastEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        parent.broadcastEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should not broadcast aborted event to children'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).abort()
        child.broadcastEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        parent.broadcastEvent event
        pass.should.be.ok</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>After the event validation logic, and before broadcast to the children, the event must be
dispatched to the listeners.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it <span class="hljs-string">'should call dispatchEvent on this Evented instance before broadcasting it to children'</span>, <span class="hljs-function">-&gt;</span>
        broadcasted = <span class="hljs-literal">no</span>
        dispatched = <span class="hljs-literal">no</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).appendChild(child = <span class="hljs-keyword">new</span> Evented)
        parent.dispatchEvent = <span class="hljs-function">-&gt;</span> dispatched = <span class="hljs-keyword">not</span> broadcasted
        child.broadcastEvent = <span class="hljs-function">-&gt;</span> broadcasted = <span class="hljs-literal">yes</span>
        parent.broadcastEvent <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>
        broadcasted.should.be.ok
        dispatched.should.be.ok

      it <span class="hljs-string">'should not call dispatchEvent if event is finished'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).dispatchEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).phase = <span class="hljs-number">3</span>
        parent.broadcastEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should not call dispatchEvent if event is aborted'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (parent = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>).dispatchEvent = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).abort()
        parent.broadcastEvent event
        pass.should.be.ok</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>If the event has reached it’s target, and bubbling is not enabled, then the event is considered
as <strong>done</strong>, and the event callback must be called.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      it <span class="hljs-string">'should call event callback upon completion if event source is this Evented instance'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">no</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).callback = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">yes</span>
        event.target = (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
        test.broadcastEvent event
        pass.should.be.ok

      it <span class="hljs-string">'should not call event callback for finished events'</span>, <span class="hljs-function">-&gt;</span>
        pass = <span class="hljs-literal">yes</span>
        (event = <span class="hljs-keyword">new</span> Event <span class="hljs-string">'test'</span>).callback = <span class="hljs-function">-&gt;</span> pass = <span class="hljs-literal">no</span>
        event.phase = <span class="hljs-number">4</span>
        event.target = (test = <span class="hljs-keyword">new</span> Evented <span class="hljs-attribute">events</span>:<span class="hljs-attribute">test</span>:<span class="hljs-literal">true</span>)
        test.broadcastEvent event
        pass.should.be.ok</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
